[TOC]

## [正则简介](https://www.jb51.net/tools/zhengze.html)

通配符：由shell解析，用于命令find，ls，cp，mv等查找文件名。

正则：进行文本匹配的工具，比通配符能更精确地描述需求。

### 通配符

```bash
*        任意字符
？       一个任意字符
^        取反
[0-9]    范围
[c1|c2]  条件1或条件2，从左到右匹配到则停止  
```

### 元字符

```shell
.	      匹配除换行符以外的任意字符
^	      匹配字符串的开始
$	      匹配字符串的结束
\w	    匹配字母或数字或下划线或汉字,，等价于a-z0-9A-Z_
\s	    匹配任意的空白符
\d	    匹配数字,等价于[0-9]
\b	    匹配单词的开始或结束

# 反义
\W	    匹配任意不是字母，数字，下划线，汉字的字符
\S	    匹配任意不是空白符的字符
\D	    匹配任意非数字的字符
\B	    匹配不是单词开头或结束的位置
[^x]    匹配除了x以外的任意字符
[^ae]	  匹配除了ae这几个字母以外的任意字符

# 转义
\       转义字符
\\      匹配\
\*      匹配*
```

### 限定符

```bash
# 用于重复单个字符
# 重复限定符
*	     重复零次或更多次,任意数量的不包含换行的字符
+	     重复一次或更多次
?	     重复零次或一次
{n}	   重复n次
{n,m}  重复n到m次
{n,}   重复n次或更多次

# 懒惰限定符
*?	    重复任意次，但尽可能少重复
+?	    重复1次或更多次，但尽可能少重复
??	    重复0次或1次，但尽可能少重复
{n,m}?	重复n到m次，但尽可能少重复
{n,}?	  重复n次以上，但尽可能少重复
```

```bash
# 精确地查找hi这个单词
\bhi\b

# 先是单词hi,然后是任意个任意字符(但不能是换行)，最后是Lucy这个单词
\bhi\b.*\bLucy\b

# 以0开头，然后是两个数字，然后是一个连字号“-”，最后是8个数字
0\d{2}-\d{8}

# 匹配刚好6个字符的单词
\b\w{6}\b

# QQ号必须为5位到12位数字
\d{5,12}

# 匹配最长的以a开始，以b结束的字符串，称为贪婪匹配
a.*b

# 匹配最短的，以a开始，以b结束的字符串
a.*?b
```

### 修饰符

```bash
i   不区分(ignore)大小写
g   全局(global)匹配
m   多(more)行匹配
s   匹配元字符.包含换行符
```

```bash
# 匹配 abc、aBC、Abc
str="aBC"
reg=/abc/i
str.match(reg)

# 匹配字符串中第一个a字母
str="abcabcabc"
reg=/a/
str.match(reg)

# 匹配字符中所有a字母
str="abcabcabc"
reg=/a/g
str.match(reg)

# 匹配多行中的字符abc
str="abc\nbbbb\nabc"
reg=/^abc/gm
str.match(reg)

# 默认元字符.匹配不包含换行符，加上s后匹配c\n
str="abc\nbbbb\nabc"
reg=/c./s
str.match(reg)  # 'c\n'
```

### 分组

```bash
# 用于重复多个字符
# 默认规则：从左到右每个分组都有组号，类似数组下标
# 反向引用：可通过组号引用分组

(exp)         匹配exp，捕获匹配的文本，组号自动按位置分配
(?<name>exp)	匹配exp，捕获匹配的文本，组号为name
(?:exp)	      匹配exp,不捕获匹配的文本，无组号
(?#comment)	  提供注释
```

```bash
# 匹配 0.0.0.0 ～ 999.999.999
(\d{1,3}\.){3}\d{1,3}

# 匹配IP 0.0.0.0 ～255.255.255
# 1位 0～9       \d
# 2位 10～99     [1-9]\d
# 3位 100～199   1\d\d
# 3位 200～249   2[0-4]\d
# 3位 250～255   25[0-4]
(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-4]\.){3}(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-4])
# 或者
# 0～199       [0-1]?\d?\d
# 200～249     2[0-4]\d
# 250～255     25[0-5]
([0-1]?\d?\d|2[0-4]\d|25[0-5]\.){3}([0-1]?\d?\d|2[0-4]\d|25[0-5])
([0-1]?\d?\d(?#0-199)|2[0-4]\d(?#200-249)|25[0-5](?#249-255)\.){3}([0-1]?\d?\d|2[0-4]\d|25[0-5])

# 反向引用组号1匹配 字符空格字符
str="a1 a1 ab"
reg=/\b(\w+)\b\s+\1\b/
reg.test(str)        # true
reg.test("a1 ab a1") # false
str.match(reg)[1]    # a1

# 反向引用组号work匹配 字符空格字符
str="11 aa aa"
reg=/\b(?<Word>\w+)\b\s+\k<Word>\b/
reg.test(str)        # true
str.match(reg)[1]    # aa

# 非捕获 匹配日期，只获取月份及日期
str="2012-01-11"
reg=/(?:\d{4})-(\d{2})-(\d{2})/
str.match(reg)[1]  # 01
str.match(reg)[2]  # 11
```

### 断言

```bash
#  指定匹配截止位置，不包含匹配条件

# 零宽断言
(?=exp)	      匹配前面是exp
(?<=exp)	    匹配后面是exp

# 负向零宽断言
(?!exp)	      匹配后面不是exp
(?<!exp)	    匹配前面不是exp
```

```bash
# 匹配以a分割的数字
str="b11aab22bc"
reg=/\d+(?=a)/g
str.match(reg)   # 11

# 匹配%分号前的数字，先行断言
str="100% have 200% been male"
reg=/\d+(?=%)/g
reg.exec(str)  # 100
reg.exec(str)  # 200

# 匹配@后面的数字，后行断言
str="@10 aaa @20"
reg=/(?<=@)\d+/
str.match(reg) # 10

# 匹配不含%后的数字，先行否定断言
str="100% have 200 been male"
reg=/\d+(?!%)/g
str.match(reg) # 10 200

# 匹配不含@后的数字，后行否定断言
str="@10 aaa &20"
reg=/(?<!@)\d+/
str.match(reg) # 0 20
```


